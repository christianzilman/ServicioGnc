@model ServicioGnc.Models.Carro


@{
    ViewBag.Title = "Compra";
}

<div class="alert alert-warning" role="alert">
    <span class="glyphicon glyphicon-shopping-cart" aria-hidden="true"></span>
    COMPRA
</div>


@using (Html.BeginForm(actionName:"ProcesarCompra",controllerName:"Carro"))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    
             @*<div id="busquedaP">
                 <input type="text" name="proveedorId" id="proveedorId" />
        <input type="button" class="btn-warning" onclick="javascript:BuscarProveedor()" value="Buscar" />

    </div>*@
    <div id="busqueda">
        <input type="text" name="productoId" id="productoId"  />
        <input type="button" class="btn-warning" onclick="javascript:BuscarProducto()" value="Buscar" />

    </div>
    <div id="productoDescripcion"></div>
    
    <div id="detalleCarro"></div>
       <br/>
    <input type="submit" class="btn-warning" onclick="javascript:ProcesarCompra()" value="Guardar" />
    <br/>
}

<div>
    @Html.ActionLink("Nueva compra", "CreateCompra")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

<script >
    function BuscarProducto(){
        var productoCodigo = $("#productoId").val();
        $.ajax({
            url: "@Url.Content("~/Producto/BuscarProducto")",
            type: 'POST',
            data: { 'productoId': productoCodigo },
            success: function (data) {
                $("#productoDescripcion").html(data);
            }
        });
    }

    function BuscarProducto(){
        var productoCodigo = $("#proveedorId").val();
        $.ajax({
            url: "@Url.Content("~/Proveedor/BuscarProveedor")",
            type: 'POST',
            data: { 'proveedorId': proveedorCodigo },
        success: function (data) {
            $("#proveedorNombre").html(data);
        }
    });
    }


    function AgregarDetalle() {
        var productoIdPanel = $("#ProductoIdPanel").val();
        var cantidad = $("#ProductoCantidad").val();
        $.ajax({
            url: "@Url.Content("~/Carro/AgregarDetalle")",
            type:'post',

            data: { 'productoId': productoIdPanel, 'cantidad': cantidad , 'tipoOperacionId': 2 },
        success: function (data) {
            $("#detalleCarro").html(data);
        }
    });


    }
</script>
